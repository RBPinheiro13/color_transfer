<!-- saved from url=(0014)about:internet -->
<pre class="code">
<span class="srcline"><span class="lineno"><a href="1,1" id="srcline1"> 1</a></span><span class="line"><span class="keyword">function</span> [<span class="var type1" id="S2T1U3">A_mean</span> , <span class="var type1" id="S3T2U4">Q_inv</span>] = desc_Q(<span class="var type1" id="S4T3U7">img_target</span>,<span class="var type1" id="S5T4U8">labels</span>,<span class="var type1" id="S6T5U9">numlabels</span>,<span class="var type1" id="S7T6U10">count</span>,<span class="var type1" id="S8T7U11">par_s</span>,<span class="var type1" id="S9T7U12">par_c</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="1,2" id="srcline2"> 2</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,3" id="srcline3"> 3</a></span><span class="line"><span class="mxinfo " id="T7:U9">[<span class="var type1" id="S10T7U16">i</span>,<span class="var type1" id="S11T7U17">j</span>,<span class="var type1" id="S12T7U18">k</span>] = size(<span class="var type1" id="S4T3U21">img_target</span>)</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,4" id="srcline4"> 4</a></span><span class="line"><span class="mxinfo " id="T2:U14"><span class="var type1" id="S3T2U24">Q_inv</span> = <span class="mxinfo " id="T2:U16">zeros(<span class="mxinfo " id="T7:U17">5</span>,<span class="mxinfo " id="T7:U18">5</span>,<span class="mxinfo " id="T7:U19">339</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,5" id="srcline5"> 5</a></span><span class="line"><span class="mxinfo " id="T8:U20"><span class="var type1" id="S15T8U32">c</span> = <span class="mxinfo " id="T8:U22">ones(<span class="mxinfo " id="T7:U23">1</span>,<span class="var type1" id="S6T5U36">numlabels</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,6" id="srcline6"> 6</a></span><span class="line"><span class="mxinfo " id="T1:U25"><span class="var type1" id="S2T1U39">A_mean</span> = <span class="mxinfo " id="T1:U27">zeros(<span class="mxinfo " id="T7:U28">5</span>,<span class="var type1" id="S6T5U43">numlabels</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,7" id="srcline7"> 7</a></span><span class="line"><span class="keyword">for</span> <span class="var type1" id="S17T5U46">y</span> = <span class="mxinfo " id="T5:U31">1</span>:<span class="var type1" id="S6T5U49">numlabels</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,8" id="srcline8"> 8</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,9" id="srcline9"> 9</a></span><span class="line">    <span class="mxinfo " id="T9:U33"><span class="var type1" id="S18T9U52">A_i</span> = <span class="mxinfo " id="T9:U35">zeros(<span class="mxinfo " id="T7:U36"><span class="var type1" id="S7T6U56">count</span>(<span class="var type1" id="S17T5U57">y</span>)</span>,<span class="mxinfo " id="T7:U39">5</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,10" id="srcline10">10</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,11" id="srcline11">11</a></span><span class="line">    <span class="keyword">for</span> <span class="var type1" id="S19T7U61">pos</span> = <span class="mxinfo " id="T7:U41">1</span>:<span class="var type1" id="S10T7U64">i</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,12" id="srcline12">12</a></span><span class="line">        <span class="keyword">for</span> <span class="var type1" id="S20T7U67">pos2</span> = <span class="mxinfo " id="T7:U44">1</span>:<span class="var type1" id="S11T7U70">j</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,13" id="srcline13">13</a></span><span class="line">            </span></span>
<span class="srcline"><span class="lineno"><a href="1,14" id="srcline14">14</a></span><span class="line">            <span class="mxinfo " id="T5:U46"><span class="var type1" id="S21T5U73">x</span> = <span class="mxinfo " id="T5:U48"><span class="var type1" id="S5T4U75">labels</span>(<span class="var type1" id="S19T7U76">pos</span>,<span class="var type1" id="S20T7U77">pos2</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,15" id="srcline15">15</a></span><span class="line">            </span></span>
<span class="srcline"><span class="lineno"><a href="1,16" id="srcline16">16</a></span><span class="line">            <span class="keyword">if</span> <span class="mxinfo " id="T10:U52"><span class="var type1" id="S21T5U81">x</span> == <span class="mxinfo " id="T5:U54"><span class="var type1" id="S17T5U83">y</span>-<span class="mxinfo " id="T7:U56">1</span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,17" id="srcline17">17</a></span><span class="line">                </span></span>
<span class="srcline"><span class="lineno"><a href="1,18" id="srcline18">18</a></span><span class="line">                <span class="mxinfo " id="T11:U57"><span class="mxinfo " id="T11:U58"><span class="var type1" id="S18T9U88">A_i</span>(<span class="mxinfo " id="T7:U60"><span class="var type1" id="S15T8U90">c</span>(<span class="mxinfo " id="T5:U62"><span class="var type1" id="S21T5U92">x</span>+<span class="mxinfo " id="T7:U64">1</span></span>)</span>,<span class="mxinfo " id="T11:U65"><span class="mxinfo " id="T7:U66">1</span>:<span class="mxinfo " id="T7:U67">2</span></span>)</span> = <span class="mxinfo " id="T11:U68">[<span class="mxinfo " id="T7:U69"><span class="var type1" id="S19T7U100">pos</span>/<span class="var type1" id="S10T7U101">i</span></span>,<span class="mxinfo " id="T7:U72"><span class="var type1" id="S20T7U103">pos2</span>/<span class="var type1" id="S11T7U104">j</span></span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,19" id="srcline19">19</a></span><span class="line">                <span class="mxinfo " id="T12:U75"><span class="mxinfo " id="T12:U76"><span class="var type1" id="S18T9U108">A_i</span>(<span class="mxinfo " id="T7:U78"><span class="var type1" id="S15T8U110">c</span>(<span class="mxinfo " id="T5:U80"><span class="var type1" id="S21T5U112">x</span>+<span class="mxinfo " id="T7:U82">1</span></span>)</span>,<span class="mxinfo " id="T12:U83"><span class="mxinfo " id="T7:U84">3</span>:<span class="mxinfo " id="T7:U85">5</span></span>)</span> = <span class="mxinfo " id="T13:U86"><span class="mxinfo " id="T13:U87"><span class="var type1" id="S4T3U119">img_target</span>(<span class="var type1" id="S19T7U120">pos</span>,<span class="var type1" id="S20T7U121">pos2</span>,<span class="mxinfo " id="T14:U91">:</span>)</span>/255</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,20" id="srcline20">20</a></span><span class="line">                <span class="mxinfo " id="T7:U92"><span class="mxinfo " id="T7:U93"><span class="var type1" id="S15T8U127">c</span>(<span class="mxinfo " id="T5:U95"><span class="var type1" id="S21T5U129">x</span>+<span class="mxinfo " id="T7:U97">1</span></span>)</span> = <span class="mxinfo " id="T7:U98"><span class="mxinfo " id="T7:U99"><span class="var type1" id="S15T8U133">c</span>(<span class="mxinfo " id="T5:U101"><span class="var type1" id="S21T5U135">x</span>+<span class="mxinfo " id="T7:U103">1</span></span>)</span>+<span class="mxinfo " id="T7:U104">1</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,21" id="srcline21">21</a></span><span class="line">                </span></span>
<span class="srcline"><span class="lineno"><a href="1,22" id="srcline22">22</a></span><span class="line">            <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,23" id="srcline23">23</a></span><span class="line">        <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,24" id="srcline24">24</a></span><span class="line">        </span></span>
<span class="srcline"><span class="lineno"><a href="1,25" id="srcline25">25</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,26" id="srcline26">26</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,27" id="srcline27">27</a></span><span class="line">    <span class="mxinfo " id="T15:U105"><span class="var type1" id="S22T15U140">X_i</span> = <span class="mxinfo " id="T15:U107">cov(<span class="mxinfo " id="T16:U108"><span class="var type1" id="S18T9U144">A_i</span>(<span class="mxinfo " id="T17:U110">:</span>,<span class="mxinfo " id="T18:U111">1:2</span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,28" id="srcline28">28</a></span><span class="line">    <span class="mxinfo " id="T19:U112"><span class="var type1" id="S24T19U151">C_i</span> = <span class="mxinfo " id="T19:U114">cov(<span class="mxinfo " id="T20:U115"><span class="var type1" id="S18T9U155">A_i</span>(<span class="mxinfo " id="T17:U117">:</span>,<span class="mxinfo " id="T14:U118">3:5</span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,29" id="srcline29">29</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,30" id="srcline30">30</a></span><span class="line">    <span class="mxinfo " id="T21:U119"><span class="mxinfo " id="T21:U120"><span class="var type1" id="S3T2U163">Q_inv</span>(<span class="mxinfo " id="T22:U122">:</span>,<span class="mxinfo " id="T22:U123">:</span>,<span class="var type1" id="S17T5U166">y</span>)</span> = <span class="mxinfo " id="T23:U125">inv(<span class="mxinfo " id="T23:U126">blkdiag(<span class="mxinfo " id="T15:U127">(<span class="mxinfo " id="T7:U128"><span class="var type1" id="S8T7U174">par_s</span>^2</span>).*<span class="var type1" id="S22T15U176">X_i</span></span>,<span class="mxinfo " id="T19:U131">(<span class="mxinfo " id="T7:U132"><span class="var type1" id="S9T7U180">par_c</span>^2</span>).*<span class="var type1" id="S24T19U182">C_i</span></span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,31" id="srcline31">31</a></span><span class="line">    <span class="mxinfo " id="T24:U135"><span class="mxinfo " id="T24:U136"><span class="var type1" id="S2T1U186">A_mean</span>(<span class="mxinfo " id="T22:U138">:</span>,<span class="var type1" id="S17T5U188">y</span>)</span> = <span class="mxinfo " id="T25:U140">mean(<span class="var type1" id="S18T9U191">A_i</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,32" id="srcline32">32</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,33" id="srcline33">33</a></span><span class="line"><span class="keyword"><span class="keyword">end</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,34" id="srcline34">34</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,35" id="srcline35">35</a></span><span class="line">    </span></span>
</pre>
