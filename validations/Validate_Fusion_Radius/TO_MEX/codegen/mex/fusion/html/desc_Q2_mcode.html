<!-- saved from url=(0014)about:internet -->
<pre class="code">
<span class="srcline"><span class="lineno"><a href="2,1" id="srcline1"> 1</a></span><span class="line"><span class="keyword">function</span> [<span class="var type1" id="S2T7U3">A_mean</span> , <span class="var type1" id="S3T8U4">Q_inv</span>] = desc_Q(<span class="var type1" id="S4T1U7">img_target</span>,<span class="var type1" id="S5T2U8">labels</span>,<span class="var type1" id="S6T3U9">numlabels</span>,<span class="var type1" id="S7T4U10">count</span>,<span class="var type1" id="S8T6U11">par_s</span>,<span class="var type1" id="S9T6U12">par_c</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="2,2" id="srcline2"> 2</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="2,3" id="srcline3"> 3</a></span><span class="line"><span class="mxinfo " id="T6:U9">[<span class="var type1" id="S10T6U16">i</span>,<span class="var type1" id="S11T6U17">j</span>,<span class="var type1" id="S12T6U18">k</span>] = size(<span class="var type1" id="S4T1U21">img_target</span>)</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="2,4" id="srcline4"> 4</a></span><span class="line"><span class="mxinfo " id="T8:U14"><span class="var type1" id="S3T8U24">Q_inv</span> = <span class="mxinfo " id="T8:U16">zeros(<span class="mxinfo " id="T6:U17">5</span>,<span class="mxinfo " id="T6:U18">5</span>,<span class="mxinfo " id="T6:U19">339</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="2,5" id="srcline5"> 5</a></span><span class="line"><span class="mxinfo " id="T12:U20"><span class="var type1" id="S15T12U32">c</span> = <span class="mxinfo " id="T12:U22">ones(<span class="mxinfo " id="T6:U23">1</span>,<span class="var type1" id="S6T3U36">numlabels</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="2,6" id="srcline6"> 6</a></span><span class="line"><span class="mxinfo " id="T7:U25"><span class="var type1" id="S2T7U39">A_mean</span> = <span class="mxinfo " id="T7:U27">zeros(<span class="mxinfo " id="T6:U28">5</span>,<span class="var type1" id="S6T3U43">numlabels</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="2,7" id="srcline7"> 7</a></span><span class="line"><span class="keyword">for</span> <span class="var type1" id="S17T3U46">y</span> = <span class="mxinfo " id="T10:U31"><span class="mxinfo " id="T3:U32">1</span>:<span class="var type1" id="S6T3U49">numlabels</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="2,8" id="srcline8"> 8</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="2,9" id="srcline9"> 9</a></span><span class="line">    <span class="mxinfo " id="T13:U34"><span class="var type1" id="S18T13U52">A_i</span> = <span class="mxinfo " id="T13:U36">zeros(<span class="mxinfo " id="T6:U37"><span class="var type1" id="S7T4U56">count</span>(<span class="var type1" id="S17T3U57">y</span>)</span>,<span class="mxinfo " id="T6:U40">5</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="2,10" id="srcline10">10</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="2,11" id="srcline11">11</a></span><span class="line">    <span class="keyword">for</span> <span class="var type1" id="S19T6U61">pos</span> = <span class="mxinfo " id="T4:U42"><span class="mxinfo " id="T6:U43">1</span>:<span class="var type1" id="S10T6U64">i</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="2,12" id="srcline12">12</a></span><span class="line">        <span class="keyword">for</span> <span class="var type1" id="S20T6U67">pos2</span> = <span class="mxinfo " id="T4:U46"><span class="mxinfo " id="T6:U47">1</span>:<span class="var type1" id="S11T6U70">j</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="2,13" id="srcline13">13</a></span><span class="line">            </span></span>
<span class="srcline"><span class="lineno"><a href="2,14" id="srcline14">14</a></span><span class="line">            <span class="mxinfo " id="T3:U49"><span class="var type1" id="S21T3U73">x</span> = <span class="mxinfo " id="T3:U51"><span class="var type1" id="S5T2U75">labels</span>(<span class="var type1" id="S19T6U76">pos</span>,<span class="var type1" id="S20T6U77">pos2</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="2,15" id="srcline15">15</a></span><span class="line">            </span></span>
<span class="srcline"><span class="lineno"><a href="2,16" id="srcline16">16</a></span><span class="line">            <span class="keyword">if</span> <span class="mxinfo " id="T14:U55"><span class="var type1" id="S21T3U81">x</span> == <span class="mxinfo " id="T3:U57"><span class="var type1" id="S17T3U83">y</span>-<span class="mxinfo " id="T6:U59">1</span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="2,17" id="srcline17">17</a></span><span class="line">                </span></span>
<span class="srcline"><span class="lineno"><a href="2,18" id="srcline18">18</a></span><span class="line">                <span class="mxinfo " id="T15:U60"><span class="mxinfo " id="T15:U61"><span class="var type1" id="S18T13U88">A_i</span>(<span class="mxinfo " id="T6:U63"><span class="var type1" id="S15T12U90">c</span>(<span class="mxinfo " id="T3:U65"><span class="var type1" id="S21T3U92">x</span>+<span class="mxinfo " id="T6:U67">1</span></span>)</span>,<span class="mxinfo " id="T15:U68"><span class="mxinfo " id="T6:U69">1</span>:<span class="mxinfo " id="T6:U70">2</span></span>)</span> = <span class="mxinfo " id="T15:U71">[<span class="mxinfo " id="T6:U72"><span class="var type1" id="S19T6U100">pos</span>/<span class="var type1" id="S10T6U101">i</span></span>,<span class="mxinfo " id="T6:U75"><span class="var type1" id="S20T6U103">pos2</span>/<span class="var type1" id="S11T6U104">j</span></span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="2,19" id="srcline19">19</a></span><span class="line">                <span class="mxinfo " id="T16:U78"><span class="mxinfo " id="T16:U79"><span class="var type1" id="S18T13U108">A_i</span>(<span class="mxinfo " id="T6:U81"><span class="var type1" id="S15T12U110">c</span>(<span class="mxinfo " id="T3:U83"><span class="var type1" id="S21T3U112">x</span>+<span class="mxinfo " id="T6:U85">1</span></span>)</span>,<span class="mxinfo " id="T16:U86"><span class="mxinfo " id="T6:U87">3</span>:<span class="mxinfo " id="T6:U88">5</span></span>)</span> = <span class="mxinfo " id="T17:U89"><span class="mxinfo " id="T17:U90"><span class="var type1" id="S4T1U119">img_target</span>(<span class="var type1" id="S19T6U120">pos</span>,<span class="var type1" id="S20T6U121">pos2</span>,<span class="mxinfo " id="T18:U94">:</span>)</span>/255</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="2,20" id="srcline20">20</a></span><span class="line">                <span class="mxinfo " id="T6:U95"><span class="mxinfo " id="T6:U96"><span class="var type1" id="S15T12U127">c</span>(<span class="mxinfo " id="T3:U98"><span class="var type1" id="S21T3U129">x</span>+<span class="mxinfo " id="T6:U100">1</span></span>)</span> = <span class="mxinfo " id="T6:U101"><span class="mxinfo " id="T6:U102"><span class="var type1" id="S15T12U133">c</span>(<span class="mxinfo " id="T3:U104"><span class="var type1" id="S21T3U135">x</span>+<span class="mxinfo " id="T6:U106">1</span></span>)</span>+<span class="mxinfo " id="T6:U107">1</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="2,21" id="srcline21">21</a></span><span class="line">                </span></span>
<span class="srcline"><span class="lineno"><a href="2,22" id="srcline22">22</a></span><span class="line">            <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="2,23" id="srcline23">23</a></span><span class="line">        <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="2,24" id="srcline24">24</a></span><span class="line">        </span></span>
<span class="srcline"><span class="lineno"><a href="2,25" id="srcline25">25</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="2,26" id="srcline26">26</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="2,27" id="srcline27">27</a></span><span class="line">    <span class="mxinfo " id="T19:U108"><span class="var type1" id="S22T19U140">X_i</span> = <span class="mxinfo " id="T19:U110">cov(<span class="mxinfo " id="T20:U111"><span class="var type1" id="S18T13U144">A_i</span>(<span class="mxinfo " id="T21:U113">:</span>,<span class="mxinfo " id="T22:U114">1:2</span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="2,28" id="srcline28">28</a></span><span class="line">    <span class="mxinfo " id="T19:U115"><span class="var type1" id="S24T19U151">C_i</span> = <span class="mxinfo " id="T19:U117">cov(<span class="mxinfo " id="T5:U118"><span class="var type1" id="S18T13U155">A_i</span>(<span class="mxinfo " id="T21:U120">:</span>,<span class="mxinfo " id="T18:U121">3:5</span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="2,29" id="srcline29">29</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="2,30" id="srcline30">30</a></span><span class="line">    <span class="mxinfo " id="T23:U122"><span class="mxinfo " id="T23:U123"><span class="var type1" id="S3T8U163">Q_inv</span>(<span class="mxinfo " id="T24:U125">:</span>,<span class="mxinfo " id="T24:U126">:</span>,<span class="var type1" id="S17T3U166">y</span>)</span> = <span class="mxinfo " id="T19:U128">inv(<span class="mxinfo " id="T19:U129">blkdiag(<span class="mxinfo " id="T19:U130">(<span class="mxinfo " id="T6:U131"><span class="var type1" id="S8T6U174">par_s</span>^2</span>).*<span class="var type1" id="S22T19U176">X_i</span></span>,<span class="mxinfo " id="T19:U134">(<span class="mxinfo " id="T6:U135"><span class="var type1" id="S9T6U180">par_c</span>^2</span>).*<span class="var type1" id="S24T19U182">C_i</span></span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="2,31" id="srcline31">31</a></span><span class="line">    <span class="mxinfo " id="T25:U138"><span class="mxinfo " id="T25:U139"><span class="var type1" id="S2T7U186">A_mean</span>(<span class="mxinfo " id="T24:U141">:</span>,<span class="var type1" id="S17T3U188">y</span>)</span> = <span class="mxinfo " id="T26:U143">mean(<span class="var type1" id="S18T13U191">A_i</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="2,32" id="srcline32">32</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="2,33" id="srcline33">33</a></span><span class="line"><span class="keyword"><span class="keyword">end</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="2,34" id="srcline34">34</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="2,35" id="srcline35">35</a></span><span class="line">    </span></span>
</pre>
